/* ready.js
    
    Assigns handlers to run when the HTML document has finished loading.
*/

// Document ready callstack.
var callbacks = [];

document.addEventListener("DOMContentLoaded", () => {
    while (callbacks.length) {
        callbacks.pop()();
    }
    
    callbacks = null;
});

/* Executes a callback when the document has finished loading, or on the next
    tick if the document has already loaded.
    
    cb - Callback to run when the document has loaded.
*/
module.exports = (cb) => {
    switch (document.readyState) {
        case "complete":
        case "interactive":
            new Promise((res) => {
                cb();
                res();
            });
            
            break;
        
        default:
            typeof cb === "function" && callbacks.push(cb);
    }
};
